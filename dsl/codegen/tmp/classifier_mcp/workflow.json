{
  "version": "1.0",
  "name": "classifier_mcp_example",
  "description": "Classifier agent routes to two worker agents with MCP calculator tools (SSE transport)",
  "nodes": [
    {
      "id": "start",
      "label": "Start",
      "node_type": "builtin.start",
      "config": {}
    },
    {
      "id": "classifier",
      "label": "Classifier Agent",
      "node_type": "builtin.llmagent",
      "config": {
        "model_spec": {
          "provider": "openai",
          "model_name": "deepseek-chat",
          "base_url": "https://api.deepseek.com/v1",
          "api_key": "env:OPENAI_API_KEY"
        },
        "instruction": "You are a task classifier. Classify the user's request into one of two categories:\n\n1. \"math_simple\" - Simple arithmetic operations like addition, subtraction (e.g., \"1+1\", \"5-3\", \"add 2 and 3\")\n2. \"math_complex\" - Complex calculations involving multiplication, division, or multiple operations (e.g., \"5*6\", \"10/2\", \"calculate (3+4)*2\")\n\nAnalyze the user's request and output the classification.",
        "description": "Classifies user requests into simple or complex math tasks",
        "output_format": {
          "type": "json",
          "schema": {
            "type": "object",
            "properties": {
              "classification": {
                "type": "string",
                "enum": ["math_simple", "math_complex"],
                "description": "Classification of the math task"
              },
              "reason": {
                "type": "string",
                "description": "Brief reason for the classification"
              }
            },
            "required": ["classification", "reason"]
          }
        },
        "temperature": 0.3
      }
    },
    {
      "id": "simple_math_agent",
      "label": "Simple Math Agent",
      "node_type": "builtin.llmagent",
      "config": {
        "model_spec": {
          "provider": "openai",
          "model_name": "deepseek-chat",
          "base_url": "https://api.deepseek.com/v1",
          "api_key": "env:OPENAI_API_KEY"
        },
        "instruction": "You are a simple math assistant specializing in addition and subtraction. Use the calculator tools available via MCP to help users with their calculations. Always use the tools to compute results rather than calculating yourself.",
        "description": "Handles simple arithmetic (addition, subtraction) using MCP calculator",
        "temperature": 0.5,
        "max_tokens": 1024,
        "mcp_tools": [
          {
            "name": "calculator_sse",
            "transport": "sse",
            "server_url": "http://03.mcp-gateway.woa.com/245oyJGZ7scEkoA0",
            "timeout": 30
          }
        ]
      }
    },
    {
      "id": "complex_math_agent",
      "label": "Complex Math Agent",
      "node_type": "builtin.llmagent",
      "config": {
        "model_spec": {
          "provider": "openai",
          "model_name": "deepseek-chat",
          "base_url": "https://api.deepseek.com/v1",
          "api_key": "env:OPENAI_API_KEY"
        },
        "instruction": "You are an advanced math assistant specializing in multiplication, division, and complex calculations. Use the calculator tools available via MCP to help users with their calculations. Always use the tools to compute results rather than calculating yourself.",
        "description": "Handles complex arithmetic (multiplication, division) using MCP calculator",
        "temperature": 0.5,
        "max_tokens": 1024,
        "mcp_tools": [
          {
            "name": "calculator_sse",
            "transport": "sse",
            "server_url": "http://03.mcp-gateway.woa.com/245oyJGZ7scEkoA0",
            "timeout": 30
          }
        ]
      }
    },
    {
      "id": "simple_end",
      "label": "Simple Math End",
      "node_type": "builtin.end",
      "config": {}
    },
    {
      "id": "complex_end",
      "label": "Complex Math End",
      "node_type": "builtin.end",
      "config": {}
    }
  ],
  "edges": [
    {
      "id": "edge_start_classifier",
      "source": "start",
      "target": "classifier"
    },
    {
      "id": "edge_simple_agent_end",
      "source": "simple_math_agent",
      "target": "simple_end"
    },
    {
      "id": "edge_complex_agent_end",
      "source": "complex_math_agent",
      "target": "complex_end"
    },
    {
      "id": "edge_simple_end_final",
      "source": "simple_end",
      "target": "__end__"
    },
    {
      "id": "edge_complex_end_final",
      "source": "complex_end",
      "target": "__end__"
    }
  ],
  "conditional_edges": [
    {
      "id": "route_by_classification",
      "from": "classifier",
      "condition": {
        "type": "builtin",
        "cases": [
          {
            "name": "math_simple",
            "predicate": {
              "expression": "input.output_parsed.classification == \"math_simple\"",
              "format": "cel"
            },
            "target": "simple_math_agent"
          },
          {
            "name": "math_complex",
            "predicate": {
              "expression": "input.output_parsed.classification == \"math_complex\"",
              "format": "cel"
            },
            "target": "complex_math_agent"
          }
        ]
      }
    }
  ],
  "start_node_id": "start"
}
