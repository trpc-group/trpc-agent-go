# Suspend/Resume ç¤ºä¾‹

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `graph` + `graphagent` + `runner` ç»„åˆæ¥å®ç°å·¥ä½œæµçš„ä¸­æ–­å’Œæ¢å¤åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- **å·¥ä½œæµå®šä¹‰**: ä½¿ç”¨ `StateGraph` æ„å»ºå™¨å®šä¹‰å·¥ä½œæµ
- **èŠ‚ç‚¹æ‰§è¡Œ**: æ”¯æŒå‡½æ•°èŠ‚ç‚¹ã€LLMèŠ‚ç‚¹ã€å·¥å…·èŠ‚ç‚¹ç­‰
- **ä¸­æ–­æœºåˆ¶**: èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨ `graph.Suspend()` ä¸­æ–­æ‰§è¡Œ
- **æ¢å¤æœºåˆ¶**: ä½¿ç”¨ `Command.ResumeMap` æ¢å¤æ‰§è¡Œ
- **æ£€æŸ¥ç‚¹**: è‡ªåŠ¨ä¿å­˜å’Œæ¢å¤æ‰§è¡ŒçŠ¶æ€

## å·¥ä½œæµç»“æ„

```
start â†’ process â†’ approval â†’ complete
                â†‘
            (ä¸­æ–­ç‚¹)
```

1. **start**: åˆå§‹åŒ–å·¥ä½œæµ
2. **process**: å¤„ç†ä¸šåŠ¡é€»è¾‘
3. **approval**: å®¡æ‰¹èŠ‚ç‚¹ï¼ˆä¼šä¸­æ–­ç­‰å¾…äººå·¥å®¡æ‰¹ï¼‰
4. **complete**: å®Œæˆå·¥ä½œæµ

## ä½¿ç”¨æ–¹æ³•

### 1. è¿è¡Œç¤ºä¾‹

```bash
cd examples/graph/suspendresume
go run main.go
```

### 2. é¢„æœŸè¾“å‡º

```
ğŸš€ å¼€å§‹è¿è¡Œ Suspend/Resume æ¼”ç¤º...

ğŸ”„ ç¬¬ä¸€æ¬¡è¿è¡Œ - ä¼šä¸­æ–­ç­‰å¾…å®¡æ‰¹...
ğŸ“ å¼€å§‹èŠ‚ç‚¹: åˆå§‹åŒ–å·¥ä½œæµ
âš™ï¸ å¤„ç†èŠ‚ç‚¹: å¤„ç†ä¸šåŠ¡é€»è¾‘
â¸ï¸ å®¡æ‰¹èŠ‚ç‚¹: æ£€æŸ¥æ˜¯å¦éœ€è¦äººå·¥å®¡æ‰¹
â³ ç­‰å¾…äººå·¥å®¡æ‰¹...
ğŸ›‘ æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶: interrupt
ğŸ“ ä¸­æ–­èŠ‚ç‚¹: approval

ğŸ”„ æ¢å¤è¿è¡Œ - æ¨¡æ‹Ÿäººå·¥å®¡æ‰¹...
â¸ï¸ å®¡æ‰¹èŠ‚ç‚¹: æ£€æŸ¥æ˜¯å¦éœ€è¦äººå·¥å®¡æ‰¹
âœ… æ£€æµ‹åˆ°æ¢å¤å€¼: true
ğŸ‰ å®ŒæˆèŠ‚ç‚¹: å·¥ä½œæµå®Œæˆ

ğŸ“Š æœ€ç»ˆçŠ¶æ€:
  workflow_id: demo_001
  start_time: 1703123456
  message: Hello from start node
  step: 4
  processed: true
  timestamp: 1703123456
  approved: true
  approval_time: 1703123456
  completed: true
  completion_time: 1703123456
```

## å…³é”®ä»£ç 

### ä¸­æ–­èŠ‚ç‚¹

```go
func approvalNode(ctx context.Context, state graph.State) (any, error) {
    // æ£€æŸ¥æ˜¯å¦æœ‰æ¢å¤å€¼
    if approved, exists := graph.ResumeValue[bool](ctx, state, "approval"); exists {
        // å¤„ç†æ¢å¤å€¼
        return state, nil
    }
    
    // æ²¡æœ‰æ¢å¤å€¼ï¼Œéœ€è¦ä¸­æ–­ç­‰å¾…å®¡æ‰¹
    _, err := graph.Suspend(ctx, state, "approval", prompt)
    if err != nil {
        return nil, err
    }
    
    return state, nil
}
```

### æ¢å¤æ‰§è¡Œ

```go
// åˆ›å»ºæ¢å¤å‘½ä»¤
cmd := &graph.Command{
    ResumeMap: map[string]any{
        "approval": true, // æ¨¡æ‹Ÿç”¨æˆ·æ‰¹å‡†
    },
}

// åˆ›å»ºåˆå§‹çŠ¶æ€ï¼ŒåŒ…å«æ¢å¤å‘½ä»¤
initialState := graph.State{
    "workflow_id": "demo_001",
    "__command__": cmd,
}
```

## æŠ€æœ¯ç‰¹ç‚¹

- **åŸå­æ€§ä¿å­˜**: ä½¿ç”¨ `PutFull` ç¡®ä¿æ£€æŸ¥ç‚¹å’Œå†™å…¥çš„åŸå­æ€§
- **ç‰ˆæœ¬è·Ÿè¸ª**: æ”¯æŒé€šé“ç‰ˆæœ¬å’ŒèŠ‚ç‚¹ç‰ˆæœ¬è·Ÿè¸ª
- **äº‹ä»¶ç³»ç»Ÿ**: å®Œæ•´çš„äº‹ä»¶æµï¼ŒåŒ…æ‹¬ä¸­æ–­äº‹ä»¶
- **çŠ¶æ€ç®¡ç†**: è‡ªåŠ¨çŠ¶æ€ä¿å­˜å’Œæ¢å¤
- **è¶…æ—¶æ§åˆ¶**: æ”¯æŒæ­¥éª¤è¶…æ—¶å’ŒèŠ‚ç‚¹è¶…æ—¶

## æ‰©å±•åŠŸèƒ½

- **æ¡ä»¶è¾¹**: æ”¯æŒåŸºäºç»“æœçš„åŠ¨æ€è·¯ç”±
- **é€šé“ç®¡ç†**: æ”¯æŒå¤šç§é€šé“è¡Œä¸ºï¼ˆLastValueã€Topicã€Barrierï¼‰
- **æ¨¡å¼åŒ¹é…**: æ”¯æŒå¤æ‚çš„æ¡ä»¶åˆ¤æ–­å’Œè·¯ç”±é€»è¾‘
- **å¹¶è¡Œæ‰§è¡Œ**: æ”¯æŒå¤šèŠ‚ç‚¹å¹¶è¡Œæ‰§è¡Œ
- **é”™è¯¯å¤„ç†**: å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

## ç›¸å…³æ–‡æ¡£

- [Graph åŒ…æ–‡æ¡£](../../../docs/zh/graph.md)
- [Checkpoint æœºåˆ¶](../../../docs/zh/graph.md#æ£€æŸ¥ç‚¹æœºåˆ¶)
- [ä¸­æ–­å’Œæ¢å¤](../../../docs/zh/graph.md#ä¸­æ–­å’Œæ¢å¤)
- [äº‹ä»¶ç³»ç»Ÿ](../../../docs/zh/graph.md#äº‹ä»¶ç³»ç»Ÿ)
